<!DOCTYPE html>
<html lang="id">
  <head>
    <link rel="stylesheet" href="style.css" />
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link href="https://fonts.googleapis.com/css2?family=Montserrat&display=swap" rel="stylesheet">


    <title>Antripool</title>
  </head>
  <body>
    <header>
      <div class="container">
        <div class="logo">Antripool</div>
        <nav>
          <ul>
            <li><a href="#home">Beranda</a></li>
            <li><a href="#booking">Booking</a></li>
            <li><a href="#about">Tentang Kami</a></li>
            <li><a href="#contact">Kontak</a></li>
          </ul>
        </nav>
      </div>
    </header>

    <section class="hero" id="home">
      <div class="hero-content">
        <h2>Booking Tempat Billiard Online</h2>
        <p>Pesan meja billiard favorit Anda dengan mudah dan cepat</p>
        <a href="#booking" class="btn">Booking Sekarang</a>
      </div>
    </section>

    <div class="container">
      <section class="booking-section" id="booking">
        <!-- Left Column - Booking Form -->
        <div class="booking-form">
          <h3>Form Booking</h3>
          <form id="billiardBookingForm">
            <div class="form-group">
              <label for="name">Nama Lengkap</label>
              <input type="text" id="name" name="name" required />
            </div>
            <div class="form-group">
              <label for="phone">No. Handphone</label>
              <input type="tel" id="phone" name="phone" required />
            </div>
            <div class="form-group">
              <label for="tableNumber">Nomor Meja</label>
              <select id="tableNumber" name="tableNumber" required>
                <option value="">Pilih Meja</option>
                <option value="1">Meja 1</option>
                <option value="2">Meja 2</option>
                <option value="3">Meja 3</option>
                <option value="4">Meja 4</option>
                <option value="5">Meja 5</option>
                <option value="6">Meja 6</option>
              </select>
            </div>
            <div class="form-group">
              <label for="date">Tanggal Booking</label>
              <input type="date" id="date" name="date" required />
            </div>
            <div class="form-group">
              <label for="time">Jam Mulai</label>
              <input type="time" id="time" name="time" required />
              <div id="timeStatus" class="time-status"></div>
            </div>
            <div class="form-group">
              <label for="duration">Durasi (jam)</label>
              <select id="duration" name="duration" required>
                <option value="1">1 Jam</option>
                <option value="2">2 Jam</option>
                <option value="3">3 Jam</option>
                <option value="4">4 Jam</option>
              </select>
            </div>
            <button type="submit" class="btn">Konfirmasi Booking</button>
          </form>
        </div>

        <!-- Right Column - Tables and Menu -->
        <div class="right-column">
          <!-- Tables Status -->
          <div class="tables-display">
            <h3>Status Meja</h3>
            <p>Pilih meja yang tersedia (hijau)</p>
            <div class="tables-container" id="tablesContainer">
              <!-- Tables will be generated here by JavaScript -->
            </div>
          </div>

          <!-- Food and Drink Menu -->
          <div class="menu-section">
            <h3>Menu Makanan & Minuman</h3>
            <div class="menu-items">
              <div class="menu-item">
                <h4>Cireng</h4>
                <span class="price">Rp 15.000</span>
                <div class="quantity-control">
                  <button type="button" class="decrease" data-item="cireng">
                    -
                  </button>
                  <input
                    type="number"
                    id="cireng"
                    name="cireng"
                    min="0"
                    value="0"
                    readonly
                  />
                  <button type="button" class="increase" data-item="cireng">
                    +
                  </button>
                </div>
              </div>

              <div class="menu-item">
                <h4>Mix Platter</h4>
                <span class="price">Rp 45.000</span>
                <div class="quantity-control">
                  <button type="button" class="decrease" data-item="mixPlatter">
                    -
                  </button>
                  <input
                    type="number"
                    id="mixPlatter"
                    name="mixPlatter"
                    min="0"
                    value="0"
                    readonly
                  />
                  <button type="button" class="increase" data-item="mixPlatter">
                    +
                  </button>
                </div>
              </div>

              <div class="menu-item">
                <h4>Kentang Goreng</h4>
                <span class="price">Rp 25.000</span>
                <div class="quantity-control">
                  <button type="button" class="decrease" data-item="kentang">
                    -
                  </button>
                  <input
                    type="number"
                    id="kentang"
                    name="kentang"
                    min="0"
                    value="0"
                    readonly
                  />
                  <button type="button" class="increase" data-item="kentang">
                    +
                  </button>
                </div>
              </div>

              <div class="menu-item">
                <h4>Chicken Bulgogi</h4>
                <span class="price">Rp 35.000</span>
                <div class="quantity-control">
                  <button
                    type="button"
                    class="decrease"
                    data-item="chickenBulgogi"
                  >
                    -
                  </button>
                  <input
                    type="number"
                    id="chickenBulgogi"
                    name="chickenBulgogi"
                    min="0"
                    value="0"
                    readonly
                  />
                  <button
                    type="button"
                    class="increase"
                    data-item="chickenBulgogi"
                  >
                    +
                  </button>
                </div>
              </div>

              <div class="menu-item">
                <h4>Es Teh</h4>
                <span class="price">Rp 10.000</span>
                <div class="quantity-control">
                  <button type="button" class="decrease" data-item="esTeh">
                    -
                  </button>
                  <input
                    type="number"
                    id="esTeh"
                    name="esTeh"
                    min="0"
                    value="0"
                    readonly
                  />
                  <button type="button" class="increase" data-item="esTeh">
                    +
                  </button>
                </div>
              </div>

              <div class="menu-item">
                <h4>Coffee</h4>
                <span class="price">Rp 20.000</span>
                <div class="quantity-control">
                  <button type="button" class="decrease" data-item="coffee">
                    -
                  </button>
                  <input
                    type="number"
                    id="coffee"
                    name="coffee"
                    min="0"
                    value="0"
                    readonly
                  />
                  <button type="button" class="increase" data-item="coffee">
                    +
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </section>

      <section class="bookings-list">
        <h3>Booking Saya</h3>
        <div id="myBookings">
          <!-- Bookings will be displayed here by JavaScript -->
          <div class="booking-item">
            <div class="booking-details">
              <h4>Belum ada booking</h4>
              <p>Silakan lakukan booking untuk melihat daftar booking Anda</p>
            </div>
          </div>
        </div>
      </section>
    </div>

    <div class="modal" id="confirmationModal">
      <div class="modal-content">
        <span class="close-btn" id="closeModal">&times;</span>
        <h3>Konfirmasi Booking</h3>
        <div id="bookingDetails"></div>
        <button class="btn" id="confirmBooking">Konfirmasi</button>
      </div>
    </div>

    <footer>
      <div class="container">
        <p>&copy; 2025 Antripool Billiard. Semua hak dilindungi.</p>
        <div class="social-links">
          <a href="#">Facebook</a>
          <a href="#">Instagram</a>
          <a href="#">WhatsApp</a>
        </div>
      </div>
    </footer>

    <script>
      // Data untuk mensimulasikan status meja
      let tables = [
        { id: 1, name: "Meja 1", status: "available" },
        { id: 2, name: "Meja 2", status: "available" },
        { id: 3, name: "Meja 3", status: "booked" },
        { id: 4, name: "Meja 4", status: "available" },
        { id: 5, name: "Meja 5", status: "booked" },
        { id: 6, name: "Meja 6", status: "available" },
      ];

      // Array untuk menyimpan booking yang telah dibuat
      let myBookings = [];

      // Harga menu makanan/minuman
      const menuPrices = {
        cireng: 15000,
        mixPlatter: 45000,
        kentang: 25000,
        chickenBulgogi: 35000,
        esTeh: 10000,
        coffee: 20000,
      };

      // Elemen DOM
      const tablesContainer = document.getElementById("tablesContainer");
      const bookingForm = document.getElementById("billiardBookingForm");
      const myBookingsContainer = document.getElementById("myBookings");
      const modal = document.getElementById("confirmationModal");
      const closeModal = document.getElementById("closeModal");
      const bookingDetails = document.getElementById("bookingDetails");
      const confirmBookingBtn = document.getElementById("confirmBooking");
      const tableSelect = document.getElementById("tableNumber");

      // Render meja-meja billiard
      function renderTables() {
  tablesContainer.innerHTML = "";

  const now = new Date();

  tables.forEach((table) => {
    // Cek apakah meja sedang dibooking saat ini
    const isCurrentlyBooked = myBookings.some((booking) => {
      if (parseInt(booking.tableNumber) !== table.id) return false;

      const bookingStart = new Date(`${booking.date}T${booking.time}`);
      const bookingEnd = new Date(bookingStart);
      bookingEnd.setHours(bookingEnd.getHours() + parseInt(booking.duration));

      return now >= bookingStart && now < bookingEnd;
    });

    const status = isCurrentlyBooked ? "booked" : "available";

    const tableEl = document.createElement("div");
    tableEl.className = `table-item ${status}`;
    tableEl.innerHTML = `
      <h4>${table.name}</h4>
      <div class="status ${status}">${
      status === "available" ? "Tersedia" : "Terpesan"
    }</div>
    `;

    tableEl.addEventListener("click", () => selectTable(table));
    tablesContainer.appendChild(tableEl);
  });
}




      // Pilih meja dan update dropdown
      function selectTable(table) {
        if (table.status === "booked") {
          alert("Maaf, meja ini sudah terpesan. Silakan pilih meja lain.");
          return;
        }

        tableSelect.value = table.id;
        // Scroll to form
        document
          .querySelector(".booking-form")
          .scrollIntoView({ behavior: "smooth" });
      }

      // Render daftar booking
      function renderBookings() {
        if (myBookings.length === 0) {
          myBookingsContainer.innerHTML = `
                    <div class="booking-item">
                        <div class="booking-details">
                            <h4>Belum ada booking</h4>
                            <p>Silakan lakukan booking untuk melihat daftar booking Anda</p>
                        </div>
                    </div>
                `;
          return;
        }

        myBookingsContainer.innerHTML = "";
        myBookings.forEach((booking, index) => {
          const bookingEl = document.createElement("div");
          bookingEl.className = "booking-item";

          const bookingDate = new Date(booking.date + "T" + booking.time);
          const formattedDate = bookingDate.toLocaleDateString("id-ID", {
            weekday: "long",
            year: "numeric",
            month: "long",
            day: "numeric",
          });
          const formattedTime = bookingDate.toLocaleTimeString("id-ID", {
            hour: "2-digit",
            minute: "2-digit",
          });

          // Render pesanan makanan/minuman
          let foodOrders = "";
          let totalFoodPrice = 0;

          if (
            booking.foodOrders &&
            Object.keys(booking.foodOrders).length > 0
          ) {
            foodOrders = "<div class='food-orders'><h5>Pesanan:</h5><ul>";

            for (const [item, quantity] of Object.entries(booking.foodOrders)) {
              if (quantity > 0) {
                const price = menuPrices[item];
                totalFoodPrice += price * quantity;

                // Format nama item untuk ditampilkan
                const displayName = item
                  .replace(/([A-Z])/g, " $1")
                  .replace(/^./, (str) => str.toUpperCase())
                  .replace("Chicken Bulgogi", "Chicken Bulgogi")
                  .replace("Es Teh", "Es Teh")
                  .replace("Mix Platter", "Mix Platter");

                foodOrders += `<li>${displayName}: ${quantity} x Rp ${price.toLocaleString(
                  "id-ID"
                )}</li>`;
              }
            }

            foodOrders += `</ul><p><strong>Total Makanan/Minuman: Rp ${totalFoodPrice.toLocaleString(
              "id-ID"
            )}</strong></p></div>`;
          }

          bookingEl.innerHTML = `
                    <div class="booking-details">
                        <h4>Booking #${index + 1}: ${booking.name}</h4>
                        <p>Meja ${
                          booking.tableNumber
                        } - ${formattedDate} pukul ${formattedTime}</p>
                        <p>Durasi: ${booking.duration} jam (Rp ${(
            booking.duration * 50000
          ).toLocaleString("id-ID")})</p>
                        ${foodOrders}
                        <p><strong>Total Keseluruhan: Rp ${(
                          booking.duration * 50000 +
                          totalFoodPrice
                        ).toLocaleString("id-ID")}</strong></p>
                    </div>
                    <div class="booking-actions">
                        <button class="btn" onclick="cancelBooking(${index})">Batalkan</button>
                    </div>
                `;
          myBookingsContainer.appendChild(bookingEl);
        });
      }

      // Batalkan booking
      function cancelBooking(index) {
        if (confirm("Apakah Anda yakin ingin membatalkan booking ini?")) {
          const booking = myBookings[index];
          // Update status meja menjadi available
          const tableIndex = tables.findIndex(
            (t) => t.id === parseInt(booking.tableNumber)
          );
          if (tableIndex !== -1) {
            tables[tableIndex].status = "available";
          }
          // Hapus booking
          myBookings.splice(index, 1);

          // Update tampilan
          renderTables();
          renderBookings();

          alert("Booking berhasil dibatalkan");
        }
      }

      // Fungsi untuk menangani perubahan jumlah pesanan
      function setupQuantityControls() {
        // Tambahkan event listener untuk tombol + dan -
        document.querySelectorAll(".increase").forEach((button) => {
          button.addEventListener("click", function () {
            const itemId = this.getAttribute("data-item");
            const input = document.getElementById(itemId);
            input.value = parseInt(input.value) + 1;
          });
        });

        document.querySelectorAll(".decrease").forEach((button) => {
          button.addEventListener("click", function () {
            const itemId = this.getAttribute("data-item");
            const input = document.getElementById(itemId);
            if (parseInt(input.value) > 0) {
              input.value = parseInt(input.value) - 1;
            }
          });
        });
      }

      // Submit form booking
      bookingForm.addEventListener("submit", function (e) {
        e.preventDefault();

        // Validasi form
        const name = document.getElementById("name").value;
        const phone = document.getElementById("phone").value;
        // Validasi nomor telepon
        const phonePattern = /^(0|\+62|62)[0-9]{9,13}$/;
        if (!phonePattern.test(phone)) {
        alert("Nomor telepon tidak valid. Masukkan nomor yang benar (10–15 digit dan diawali 0/62/+62).");
        return;
}
        const tableNumber = document.getElementById("tableNumber").value;
        const date = document.getElementById("date").value;
        const time = document.getElementById("time").value;
        const duration = document.getElementById("duration").value;

        if (!name || !phone || !tableNumber || !date || !time || !duration) {
          alert("Mohon lengkapi semua data booking");
          return;
        }

        // Cek apakah meja tersedia
        const selectedTable = tables.find(
          (t) => t.id === parseInt(tableNumber)
        );
        const isAlreadyBooked = myBookings.some(b =>
  b.tableNumber === tableNumber &&
  b.date === date &&
  b.time === time
);
if (isAlreadyBooked) {
  alert("Jam yang dipilih sudah dibooking. Silakan pilih jam lain.");
  return;
}
        if (!selectedTable || selectedTable.status === "booked") {
          alert("Maaf, meja yang Anda pilih tidak tersedia");
          return;
        }

        // Ambil data pesanan makanan/minuman
        const foodOrders = {
          cireng: parseInt(document.getElementById("cireng").value),
          mixPlatter: parseInt(document.getElementById("mixPlatter").value),
          kentang: parseInt(document.getElementById("kentang").value),
          chickenBulgogi: parseInt(
            document.getElementById("chickenBulgogi").value
          ),
          esTeh: parseInt(document.getElementById("esTeh").value),
          coffee: parseInt(document.getElementById("coffee").value),
        };

        // Tampilkan detail booking di modal
        const bookingDate = new Date(date + "T" + time);
        const formattedDate = bookingDate.toLocaleDateString("id-ID", {
          weekday: "long",
          year: "numeric",
          month: "long",
          day: "numeric",
        });
        const formattedTime = bookingDate.toLocaleTimeString("id-ID", {
          hour: "2-digit",
          minute: "2-digit",
        });

        // Hitung total harga makanan/minuman
        let foodOrderDetails = "";
        let totalFoodPrice = 0;

        for (const [item, quantity] of Object.entries(foodOrders)) {
          if (quantity > 0) {
            const price = menuPrices[item];
            totalFoodPrice += price * quantity;

            // Format nama item untuk ditampilkan
            const displayName = item
              .replace(/([A-Z])/g, " $1")
              .replace(/^./, (str) => str.toUpperCase())
              .replace("Chicken Bulgogi", "Chicken Bulgogi")
              .replace("Es Teh", "Es Teh")
              .replace("Mix Platter", "Mix Platter");

            foodOrderDetails += `<p>${displayName}: ${quantity} x Rp ${price.toLocaleString(
              "id-ID"
            )} = Rp ${(price * quantity).toLocaleString("id-ID")}</p>`;
          }
        }

        if (totalFoodPrice > 0) {
          foodOrderDetails = `<div class="food-order-details"><h4>Pesanan Makanan/Minuman:</h4>${foodOrderDetails}<p><strong>Total Makanan/Minuman: Rp ${totalFoodPrice.toLocaleString(
            "id-ID"
          )}</strong></p></div>`;
        }

        bookingDetails.innerHTML = `
                <p><strong>Nama:</strong> ${name}</p>
                <p><strong>No. HP:</strong> ${phone}</p>
                <p><strong>Meja:</strong> Meja ${tableNumber}</p>
                <p><strong>Tanggal:</strong> ${formattedDate}</p>
                <p><strong>Jam:</strong> ${formattedTime}</p>
                <p><strong>Durasi:</strong> ${duration} jam (Rp ${(
          duration * 50000
        ).toLocaleString("id-ID")})</p>
                ${foodOrderDetails}
                <p><strong>Total Harga:</strong> Rp ${(
                  duration * 50000 +
                  totalFoodPrice
                ).toLocaleString("id-ID")}</p>
            `;

        // Tampilkan modal konfirmasi
        modal.style.display = "flex";

        // Simpan data booking untuk digunakan saat konfirmasi
        confirmBookingBtn.dataset.booking = JSON.stringify({
          name,
          phone,
          tableNumber,
          date,
          time,
          duration,
          foodOrders,
        });
      });

      // Konfirmasi booking


      // Tutup modal
      closeModal.addEventListener("click", function () {
        modal.style.display = "none";
      });

      // Tutup modal jika klik di luar modal
      window.addEventListener("click", function (event) {
        if (event.target === modal) {
          modal.style.display = "none";
        }
      });

      // Set tanggal minimal untuk input date (hari ini)
      const today = new Date();
      const yyyy = today.getFullYear();
      const mm = String(today.getMonth() + 1).padStart(2, "0");
      const dd = String(today.getDate()).padStart(2, "0");
      const todayStr = `${yyyy}-${mm}-${dd}`;
      document.getElementById("date").min = todayStr;

      // Inisialisasi tampilan
      function checkTimeAvailability() {
  const tableId = document.getElementById("tableNumber").value;
  const date = document.getElementById("date").value;
  const time = document.getElementById("time").value;
  const duration = parseInt(document.getElementById("duration").value);
  const statusDiv = document.getElementById("timeStatus");

  if (!tableId || !date || !time || !duration) {
    statusDiv.textContent = "";
    statusDiv.className = "time-status";
    return;
  }

  const selectedStart = new Date(date + "T" + time);
  const selectedEnd = new Date(selectedStart);
  selectedEnd.setHours(selectedEnd.getHours() + duration);

  const isConflict = myBookings.some((booking) => {
    if (booking.tableNumber !== tableId || booking.date !== date) return false;

    const bookingStart = new Date(booking.date + "T" + booking.time);
    const bookingEnd = new Date(bookingStart);
    bookingEnd.setHours(bookingEnd.getHours() + parseInt(booking.duration));

    // Cek tabrakan waktu
    return (
      selectedStart < bookingEnd &&
      selectedEnd > bookingStart
    );
  });

  if (isConflict) {
    statusDiv.textContent = "❌ Jam ini bentrok dengan booking lain";
    statusDiv.className = "time-status booked";
  } else {
    statusDiv.textContent = "✅ Jam tersedia";
    statusDiv.className = "time-status available";
  }
}

document.getElementById("tableNumber").addEventListener("change", checkTimeAvailability);
document.getElementById("date").addEventListener("change", checkTimeAvailability);
document.getElementById("time").addEventListener("change", checkTimeAvailability);

      renderTables();
      renderBookings();
      setupQuantityControls();
    </script>
    
    <div id="tableAlert" class="table-alert">
        Maaf, meja ini sudah terpesan. Silakan pilih meja lain.
      </div>
      <script>
        // Fungsi untuk menampilkan notifikasi saat meja terpesan diklik
        function showTableAlert() {
          const alertEl = document.getElementById("tableAlert");
          alertEl.style.display = "block";
      
          // Sembunyikan otomatis setelah 3 detik
          setTimeout(() => {
            alertEl.style.display = "none";
          }, 3000);
        }
      
        function selectTable(table) {
          if (table.status === "booked") {
            showTableAlert(); // Menampilkan notifikasi
            return;
          }
      
          tableSelect.value = table.id;
          document.querySelector(".booking-form").scrollIntoView({ behavior: "smooth" });
        }
      
        // Tambahkan kode JavaScript lainnya di sini...
      </script>
      <script>
        if (!confirmBookingBtn.dataset.listenerAdded) {
// Periksa jika event listener sudah ditambahkan sebelumnya
if (!confirmBookingBtn.dataset.listenerAdded) {
  confirmBookingBtn.addEventListener("click", function () {
    const bookingData = JSON.parse(this.dataset.booking);

    // Update status meja
    const tableIndex = tables.findIndex(
      (t) => t.id === parseInt(bookingData.tableNumber)
    );
    if (tableIndex !== -1) {
      tables[tableIndex].status = "booked";
    }

    // Tambahkan ke daftar booking
    myBookings.push(bookingData);

    // Update tampilan
    renderTables();
    renderBookings();

    // Tutup modal
    modal.style.display = "none";

    // Reset form
    bookingForm.reset();

    // Reset jumlah pesanan makanan/minuman
    document
      .querySelectorAll('.menu-items input[type="number"]')
      .forEach((input) => {
        input.value = 0;
      });

    // Panggil fungsi untuk menampilkan pesan sukses
    showBookingSuccess();
  });

  // Tandai bahwa listener telah ditambahkan
  confirmBookingBtn.dataset.listenerAdded = true;
}

  // Tandai bahwa listener telah ditambahkan
  confirmBookingBtn.dataset.listenerAdded = true;
}
function showBookingSuccess() {
  // Cek jika elemen dengan class .booking-success sudah ada
  const existingSuccessMessage = document.querySelector(".booking-success");

  if (existingSuccessMessage) {
    // Jika sudah ada, kita bisa langsung kembali (tidak melakukan apa-apa)
    return;
  }

  // Membuat elemen untuk animasi sukses
  const successMessage = document.createElement("div");
  successMessage.classList.add("booking-success");
  successMessage.textContent = "Booking berhasil dikonfirmasi!";

  // Menambahkan elemen ke dalam body
  document.body.appendChild(successMessage);

  // Menampilkan pesan dengan animasi fade-in
  successMessage.style.display = "block";
  successMessage.classList.add("fade-in");

  // Tambahkan efek animasi lain setelah 1 detik
  setTimeout(() => {
    successMessage.classList.add("scale-up");
  }, 1000);

  // Sembunyikan pesan setelah 4 detik
  setTimeout(() => {
    successMessage.style.display = "none";
    successMessage.classList.remove("fade-in", "scale-up");
  }, 4000);  // Sembunyikan setelah 4 detik
}

    </script>
    
  </body>
</html>
